schema: '2.0'
stages:
  train:
    cmd: python code/tiny_train.py
    deps:
    - path: code/bert_dataset.py
      hash: md5
      md5: 2ccd2048730f95ec2da5befba772c2a0
      size: 18589
    - path: code/tiny_train.py
      hash: md5
      md5: f637c9facb252a4c4b4ebfab631ccf9b
      size: 3108
    params:
      params.yaml:
        train.batch_size: 64
        train.d_model: 768
        train.dropout: 0.1
        train.epochs: 50
        train.heads: 12
        train.lr: 5e-05
        train.weight_decay: 0.01
    outs:
    - path: models/tinybert_saved_model
      hash: md5
      md5: 741acca2b1df8e8649a50180f4f9691f.dir
      size: 18495514
      nfiles: 6
  export:
    cmd: python code/export.py
    deps:
    - path: code/export.py
      hash: md5
      md5: fedac6700d97389ffbb411c07d4f19c3
      size: 1529
    - path: models/tinybert_saved_model
      hash: md5
      md5: 741acca2b1df8e8649a50180f4f9691f.dir
      size: 18495514
      nfiles: 6
    outs:
    - path: models/tinybert.onnx
      hash: md5
      md5: 16609f819e851949ff3b72862737d237
      size: 17603568
  evaluate:
    cmd: python code/evaluate_model.py
    deps:
    - path: code/evaluate_model.py
      hash: md5
      md5: 5ef325503ec9cd6dba9a41023bb67a27
      size: 3039
    - path: models/tinybert_saved_model
      hash: md5
      md5: 741acca2b1df8e8649a50180f4f9691f.dir
      size: 18495514
      nfiles: 6
  measure:
    cmd: python code/measure_2.py
    deps:
    - path: code/bar_1.json
      hash: md5
      md5: 1abfce1ddffdd19b77a5a827b726a824
      size: 474
    - path: code/bar_2.json
      hash: md5
      md5: 77565dd0c332852d5f4c81098fc7e689
      size: 484
    - path: code/bar_3.json
      hash: md5
      md5: 6ba9c58f2f53a67b418881645060cb70
      size: 591
    - path: code/bar_4.json
      hash: md5
      md5: c30440284b82ff8b40f4dedae38c9992
      size: 592
    - path: code/measure_2.py
      hash: md5
      md5: 775febe7db9655154eab77ee871fc112
      size: 18411
    - path: datasets/tokenized_agnews_test.pt
      hash: md5
      md5: db0ea7f0705e65f4873ac08d1a160cc8
      size: 15627446
    - path: models/model.onnx
      hash: md5
      md5: e53f4cfd9826570048a87b4f58779a6c
      size: 17639925
    - path: models/tinybert_saved_model
      hash: md5
      md5: 741acca2b1df8e8649a50180f4f9691f.dir
      size: 18495514
      nfiles: 6
    outs:
    - path: throughput/latency_results.json
      hash: md5
      md5: b40b5d36a13e43984f750536b2d9aae5
      size: 1941
    - path: throughput/latency_results_batch.json
      hash: md5
      md5: 77c6dd1488933370a0f69d3e701994e8
      size: 1938
    - path: throughput/throughput_results.json
      hash: md5
      md5: d23f5168db685432c996181a486d8a2c
      size: 880
    - path: throughput/throughput_results_2.json
      hash: md5
      md5: d23f5168db685432c996181a486d8a2c
      size: 880
  quantize:
    cmd: python code/brevitas_quant.py
    deps:
    - path: code/brevitas_quant.py
      hash: md5
      md5: c2d6a5f004edfc8b0b9575140b10a285
      size: 1412
    - path: models/tinybert_saved_model
      hash: md5
      md5: 741acca2b1df8e8649a50180f4f9691f.dir
      size: 18495514
      nfiles: 6
    outs:
    - path: models/model.onnx
      hash: md5
      md5: e53f4cfd9826570048a87b4f58779a6c
      size: 17639925
