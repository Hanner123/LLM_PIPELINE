schema: '2.0'
stages:
  train:
    cmd: python code/tiny_train.py
    deps:
    - path: code/bert_dataset.py
      hash: md5
      md5: 1bc519848a6cc5be3af42e81e9372f46
      size: 18331
    - path: code/tiny_train.py
      hash: md5
      md5: 769912eca3bb18e37ad35f13fdf8943a
      size: 2914
    params:
      params.yaml:
        train.batch_size: 16
        train.d_model: 768
        train.dropout: 0.1
        train.epochs: 5
        train.heads: 12
        train.lr: 0.0001
        train.weight_decay: 0.01
    outs:
    - path: models/tinybert_saved_model
      hash: md5
      md5: 071fcd464f802e7f6c67a887667ee520.dir
      size: 18495514
      nfiles: 6
  export:
    cmd: python code/export_feste_batch_size.py
    deps:
    - path: code/export_feste_batch_size.py
      hash: md5
      md5: eee8a2cbb43b428900fb516429e86c9d
      size: 1475
    - path: models/tinybert_saved_model
      hash: md5
      md5: 071fcd464f802e7f6c67a887667ee520.dir
      size: 18495514
      nfiles: 6
    outs:
    - path: models/tinybert_1.onnx
      hash: md5
      md5: 121798d002d3dae09b6a7245209defa7
      size: 17576682
    - path: models/tinybert_1024.onnx
      hash: md5
      md5: 6fa58dfd3852ae7bdc07640e692e11d8
      size: 17576685
    - path: models/tinybert_128.onnx
      hash: md5
      md5: 24654769f90169a4a431581c4d619986
      size: 17576685
    - path: models/tinybert_16.onnx
      hash: md5
      md5: 78e453583e7493d15cb49f741034ac24
      size: 17576682
    - path: models/tinybert_2.onnx
      hash: md5
      md5: b810eaa20c7e06bd52d8db31e0e7dc70
      size: 17576682
    - path: models/tinybert_256.onnx
      hash: md5
      md5: 582b5773043d13dd97df1a866929c3a3
      size: 17576685
    - path: models/tinybert_32.onnx
      hash: md5
      md5: 1a2aabaac447a07b09c9a8d3fe1e1d57
      size: 17576682
    - path: models/tinybert_4.onnx
      hash: md5
      md5: 11cf94d5d7fb84ef61ed770151018dc1
      size: 17576682
    - path: models/tinybert_512.onnx
      hash: md5
      md5: 4db7a9b02749b211b81b50159f077cbc
      size: 17576685
    - path: models/tinybert_64.onnx
      hash: md5
      md5: 1276abb1aa0ae0fc9c4013eab49f2b36
      size: 17576682
    - path: models/tinybert_8.onnx
      hash: md5
      md5: 33008c2dad4b1d03b29fc220e5182c5f
      size: 17576682
  evaluate:
    cmd: python code/evaluate_model.py
    deps:
    - path: code/evaluate_model.py
      hash: md5
      md5: 9ca508087b32a5155746e638d5a9e316
      size: 2011
    - path: models/tinybert_saved_model
      hash: md5
      md5: 071fcd464f802e7f6c67a887667ee520.dir
      size: 18495514
      nfiles: 6
  measure:
    cmd: python code/measure_feste_batch_size.py
    deps:
    - path: code/bar_1.json
      hash: md5
      md5: 1abfce1ddffdd19b77a5a827b726a824
      size: 474
    - path: code/bar_2.json
      hash: md5
      md5: 77565dd0c332852d5f4c81098fc7e689
      size: 484
    - path: code/bar_3.json
      hash: md5
      md5: 6ba9c58f2f53a67b418881645060cb70
      size: 591
    - path: code/bar_4.json
      hash: md5
      md5: c30440284b82ff8b40f4dedae38c9992
      size: 592
    - path: code/measure_feste_batch_size.py
      hash: md5
      md5: 14aa25b7b60bfd399bc6dc91feacd80a
      size: 13529
    - path: datasets/tokenized_agnews_test.pt
      hash: md5
      md5: db0ea7f0705e65f4873ac08d1a160cc8
      size: 15627446
    - path: models/tinybert_1.onnx
      hash: md5
      md5: 121798d002d3dae09b6a7245209defa7
      size: 17576682
    - path: models/tinybert_1024.onnx
      hash: md5
      md5: 6fa58dfd3852ae7bdc07640e692e11d8
      size: 17576685
    - path: models/tinybert_128.onnx
      hash: md5
      md5: 24654769f90169a4a431581c4d619986
      size: 17576685
    - path: models/tinybert_16.onnx
      hash: md5
      md5: 78e453583e7493d15cb49f741034ac24
      size: 17576682
    - path: models/tinybert_2.onnx
      hash: md5
      md5: b810eaa20c7e06bd52d8db31e0e7dc70
      size: 17576682
    - path: models/tinybert_256.onnx
      hash: md5
      md5: 582b5773043d13dd97df1a866929c3a3
      size: 17576685
    - path: models/tinybert_32.onnx
      hash: md5
      md5: 1a2aabaac447a07b09c9a8d3fe1e1d57
      size: 17576682
    - path: models/tinybert_4.onnx
      hash: md5
      md5: 11cf94d5d7fb84ef61ed770151018dc1
      size: 17576682
    - path: models/tinybert_512.onnx
      hash: md5
      md5: 4db7a9b02749b211b81b50159f077cbc
      size: 17576685
    - path: models/tinybert_64.onnx
      hash: md5
      md5: 1276abb1aa0ae0fc9c4013eab49f2b36
      size: 17576682
    - path: models/tinybert_8.onnx
      hash: md5
      md5: 33008c2dad4b1d03b29fc220e5182c5f
      size: 17576682
    - path: models/tinybert_saved_model
      hash: md5
      md5: 071fcd464f802e7f6c67a887667ee520.dir
      size: 18495514
      nfiles: 6
    outs:
    - path: throughput/latency_results.json
      hash: md5
      md5: d64d36c05c7714291e6ca2c2dd9b0126
      size: 3604
    - path: throughput/latency_results_batch.json
      hash: md5
      md5: d4a800cdd120ce9ffe1080690ea34977
      size: 3566
    - path: throughput/throughput_results.json
      hash: md5
      md5: c4bd12e73b746fc23d07ba30ea567024
      size: 1625
    - path: throughput/throughput_results_2.json
      hash: md5
      md5: c4bd12e73b746fc23d07ba30ea567024
      size: 1625
